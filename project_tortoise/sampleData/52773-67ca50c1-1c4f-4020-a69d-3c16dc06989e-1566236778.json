{"subreddit":"programming","created_utc":1167220365,"author_flair_css_class":null,"ups":1,"score":1,"controversiality":0,"body":"The linux kernel demonstrates this. IIRC, it employs a feature of GCC that tells the optimizer not to reorder instructions around a certain point. In addition, if it is being compiled with SMP, there is also an inline asm block that contains an appropriate memory fence.\r\n\r\nA compiler could contain an intrinsic like \\_\\_load\\_acquire(x) that would have the same effect on the optimizer and produce memory fence instructions. I don't know of any specific examples of this in a compiler off hand, but I don't have extensive knowledge of that sort of thing.","stickied":false,"link_id":"t3_vzb6","subreddit_id":"t5_2fwo","gilded":0,"retrieved_on":1473809462,"distinguished":null,"author":"bdell","author_flair_text":null,"edited":false,"parent_id":"t1_cw4el","id":"cw51k","timestamp_epoch":1566236778,"message_id":"52773-67ca50c1-1c4f-4020-a69d-3c16dc06989e-1566236778"}
{"edited":false,"parent_id":"t3_u6d7","id":"cucmv","author":"dreiss","author_flair_text":null,"distinguished":null,"retrieved_on":1473808241,"gilded":0,"subreddit_id":"t5_2fwo","stickied":false,"link_id":"t3_u6d7","body":"He should have checked out __gnu_cxx::__sso_string (a.k.a. __gnu_cxx::__vstring) in GCC's &lt;ext/vstring.h&gt;.  It is basically the same implementation with two differences.  (1) Is uses the same space as \"sStatic\" to store the allocation length when the string is over 15 characters.  (2) It puts the pointer to the data first, so that getting to the characters is just a pointer dereference, not an offset then a pointer dereference.  Also, using a better malloc might have helped.\r\n\r\nEDIT: (It looks like reddit converted my underscores into formatting, and I don't see an obvious way of fixing that.  Oh well, just check the header.)","controversiality":0,"score":2,"ups":2,"created_utc":1165780415,"author_flair_css_class":null,"subreddit":"programming","timestamp_epoch":1566236765,"message_id":"20603-943ff698-8154-4800-a467-6bc9c17be073-1566236765"}
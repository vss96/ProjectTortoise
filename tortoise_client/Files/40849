{"author_flair_text":null,"author":"japple","parent_id":"t1_cw3i9","edited":false,"id":"cwbrz","gilded":0,"retrieved_on":1473809591,"distinguished":null,"body":"FWIW, here are red-black trees with the balance condition enforced by nested datatypes:\r\n\r\n    data Node a n = Node n a n\r\n\r\n    data Tree a r0 b0 r1 b1 =\r\n        Zero b1\r\n      | Succ (Tree a\r\n                  (Node a b0)\r\n                  (Node a (Either r1 b1))\r\n                   r0\r\n                   b0)\r\n\r\n    type Black2 a  = Node a (Maybe a)\r\n\r\n    type RedBlackTree a = Tree a (Node a (Black2 a)) (Black2 a) a ()\r\n\r\nAt least, I think that's right.\r\n\r\nNot only is it much less intuitive than the GADT example, it also takes O(log(n)) to reach the root node (because of all the Succ and Zero constructors), and the branches are lengthened by a constant factor because of all of the Eithers in the black nodes.","controversiality":0,"link_id":"t3_w1oz","stickied":false,"subreddit_id":"t5_2fwo","subreddit":"programming","author_flair_css_class":null,"created_utc":1167368018,"ups":2,"score":2,"timestamp_epoch":1566236779,"message_id":"56263-b2b90375-2583-4796-82ff-94dcb38aaeee-1566236779"}